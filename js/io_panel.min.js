$(function(){$("#panel_add").on("click",function(b){b.preventDefault();b.stopPropagation();var a=$(".pannel").length;if(a>7){alert("パネルを増やせるのは7個までです");return}$("#panel_area").append($("#hidden .panel").html());$("#panel_area .panel-body").sortable({connectWith:".panel-body"});return false});$(document).on("click",".panel h2",function(){var a=$(this).attr("data-id");$("#panel-modal").attr("data-id",a);if(a==="new"){$("#panel-modal #panel_title_text").val("")}else{$("#panel-modal #panel_title_text").val($(this).html())}$("#panel-modal").modal("show")});$(document).on("click","#panel-modal .modal-dialog .modal-footer button#save-panel-btn",function(){var c=$("#panel_title_text").val();var a=$("#panel-modal").attr("data-id");var b=$("#board_title").attr("data-id");if((typeof a==="undefined")||(a==="")){a="new"}exePost("panels","save",a,c,b).done(function(e){var d=$.parseJSON(e);if(a==="new"){$("#panel_area .panel").find("h2[data-id='new']").eq(0).html(d.title);$("#panel_area .panel").find("h2[data-id='new']").eq(0).attr("data-id",d.id)}else{$("#panel_area .panel h2[data-id='"+a+"']").attr("data-id",d.id);$("#panel_area .panel h2[data-id='"+a+"']").html(d.title)}$("#panel-modal").modal("hide")}).fail(function(d){alert("system Error")})});$(document).on("click","#panel-modal .modal-dialog .modal-footer button#delete-btn",function(){if(window.confirm("このパネルを削除します。よろしいですか？")){var a=$("#panel-modal").attr("data-id");exePost("panels","del",a,"","","","").done(function(){$("#panel_area .panel h2[data-id='"+a+"']").parent().parent().remove();$("#panel-modal").modal("hide")}).fail(function(){alert("system Error")})}})});